/* QQ应用样式 */

/* SillyTavern环境样式强化 */
body #chat_history_dialog,
body .chat-page,
body .qq-app-container {
  opacity: 1 !important;
  visibility: visible !important;
}

body #chat_history_dialog > div,
body .chat-page::after,
body .qq-app-container > div {
  background: #ffffff !important;
  background-color: #ffffff !important;
  opacity: 1 !important;
  filter: none !important;
}

/* 强制白色背景，不受主题影响 */
#chat_history_dialog > div,
.chat-page::after,
.qq-app-container > div {
  background: rgb(255, 255, 255) !important;
  background-color: rgb(255, 255, 255) !important;
}

/* 确保手机界面主容器的z-index也被限制 */
#phone_interface {
  z-index: 998 !important; /* 比内部应用的999低一级，确保不会意外覆盖 */
}

/* QQ应用容器样式 - 在手机界面内显示时 */
.qq-app-container {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
  width: 100% !important;
  height: 100% !important;
  background: transparent !important;
  border-radius: 50px !important;
  overflow: hidden !important;
  opacity: 1 !important;
  position: relative !important;
  z-index: 999 !important; /* 确保在手机界面内时也遵循z-index限制 */
}

.qq-app-container > div {
  width: 100% !important;
  height: 100% !important;
  background: #ffffff !important;
  border-radius: 50px !important;
  overflow: hidden !important;
  position: relative !important;
  display: flex !important;
  flex-direction: column !important;
  opacity: 1 !important;
  box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.2) !important;
}

/* QQ应用容器内的 Dynamic Island */
.qq-app-container::before {
  content: '';
  position: absolute;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  width: 120px;
  height: 28px;
  background: black;
  border-radius: 20px;
  z-index: 100;
}

/* QQ对话框样式 */
#chat_history_dialog {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
  width: 375px !important;
  height: 812px !important;
  background: transparent !important;
  border-radius: 60px !important;
  padding: 8px !important;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4) !important;
  opacity: 1 !important;
  z-index: 999 !important; /* 降低z-index，确保不会覆盖SillyTavern的其他界面 */
}

#chat_history_dialog > div {
  width: 100% !important;
  height: 100% !important;
  background: #ffffff !important;
  border-radius: 50px !important;
  overflow: hidden !important;
  position: relative !important;
  display: flex !important;
  flex-direction: column !important;
  opacity: 1 !important;
  box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.2) !important;
}

/* Dynamic Island */
#chat_history_dialog::before {
  content: '';
  position: absolute;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  width: 120px;
  height: 28px;
  background: black;
  border-radius: 20px;
  z-index: 100;
}

/* 状态栏 - 时间、电量、信号 - 统一标准 */
.qq-status-bar {
  position: absolute !important;
  top: 10px !important;
  left: 0 !important;
  right: 0 !important;
  height: 37px !important; /* 统一状态栏高度 */
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  padding: 0 20px !important; /* 统一左右内边距 */
  color: black !important;
  font-size: 14px !important;
  font-weight: 600 !important;
  z-index: 50 !important;
  pointer-events: none !important;
}

.qq-status-time {
  font-size: 18px !important; /* 统一时间字体大小 */
  font-weight: 700 !important; /* 统一时间字体粗细 */
  color: black !important;
}

.qq-status-icons {
  display: flex !important;
  align-items: center !important;
  gap: 4px !important; /* 统一图标间距 */
  font-size: 12px !important;
  color: black !important;
  font-weight: 600 !important;
}

/* 使用SVG图标替换emoji - QQ主页状态栏 - 统一标准 */
.qq-signal-icon,
.qq-battery-icon {
  display: inline-block !important;
  width: 20px !important; /* 统一图标宽度 */
  height: 14px !important; /* 统一图标高度 */
  background-size: contain !important;
  background-repeat: no-repeat !important;
  background-position: center !important;
  font-size: 0 !important; /* 隐藏emoji文字 */
}

.qq-signal-icon {
  background-image: url("data:image/svg+xml,%3Csvg width='20' height='14' viewBox='0 0 20 14' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M19.8498 2.03301C19.8498 1.39996 19.3723 0.88678 18.7832 0.88678H17.7165C17.1274 0.88678 16.6498 1.39996 16.6498 2.03301V11.967C16.6498 12.6 17.1274 13.1132 17.7165 13.1132H18.7832C19.3723 13.1132 19.8498 12.6 19.8498 11.967V2.03301ZM12.4157 3.33206H13.4824C14.0715 3.33206 14.5491 3.85756 14.5491 4.5058V11.9395C14.5491 12.5877 14.0715 13.1132 13.4824 13.1132H12.4157C11.8266 13.1132 11.3491 12.5877 11.3491 11.9395V4.5058C11.3491 3.85756 11.8266 3.33206 12.4157 3.33206ZM8.08396 5.98111H7.01729C6.42819 5.98111 5.95062 6.5133 5.95062 7.16979V11.9245C5.95062 12.581 6.42819 13.1132 7.01729 13.1132H8.08396C8.67306 13.1132 9.15062 12.581 9.15062 11.9245V7.16979C9.15062 6.5133 8.67306 5.98111 8.08396 5.98111ZM2.78317 8.4264H1.71651C1.1274 8.4264 0.649841 8.95099 0.649841 9.5981V11.9415C0.649841 12.5886 1.1274 13.1132 1.71651 13.1132H2.78317C3.37228 13.1132 3.84984 12.5886 3.84984 11.9415V9.5981C3.84984 8.95099 3.37228 8.4264 2.78317 8.4264Z' fill='black'/%3E%3C/svg%3E") !important;
}

.qq-battery-icon {
  background-image: url("data:image/svg+xml,%3Csvg width='27' height='14' viewBox='50 0 28 14' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cg clip-path='url(%23clip0_0_1)'%3E%3Cg opacity='0.3'%3E%3Cpath d='M51.6574 1.77772C50.9915 2.78661 50.9915 4.19108 50.9915 7C50.9915 9.80892 50.9915 11.2134 51.6574 12.2223C51.9457 12.659 52.3162 13.034 52.7477 13.3259C53.7444 14 55.1319 14 57.9069 14H68.7741C71.5491 14 72.9366 14 73.9333 13.3259C74.3648 13.034 74.7353 12.659 75.0236 12.2223C75.6896 11.2134 75.6896 9.80892 75.6896 7C75.6896 4.19108 75.6896 2.78661 75.0236 1.77772C74.7353 1.34096 74.3648 0.965956 73.9333 0.674122C72.9366 0 71.5491 0 68.7741 0H57.9069C55.1319 0 53.7444 0 52.7477 0.674122C52.3162 0.965956 51.9457 1.34096 51.6574 1.77772Z' fill='%235A5A5A'/%3E%3Cpath d='M77.9915 6.75C77.9915 7.62313 77.4737 8.41122 76.6775 8.75V4.75C77.4737 5.08878 77.9915 5.87687 77.9915 6.75Z' fill='%235A5A5A'/%3E%3C/g%3E%3Crect width='21' height='14' transform='translate(50.9915)' fill='%23121212'/%3E%3Cpath d='M60.0032 11.1719C59.3801 11.1719 58.8323 11.077 58.3596 10.8872C57.887 10.6938 57.5181 10.4271 57.2532 10.0869C56.9882 9.74316 56.8557 9.34749 56.8557 8.8999V8.88916C56.8557 8.55257 56.9327 8.24821 57.0867 7.97607C57.2442 7.70394 57.4591 7.47835 57.7312 7.29932C58.0033 7.1167 58.3149 6.99137 58.6658 6.92334V6.89111C58.211 6.78011 57.8422 6.57243 57.5593 6.26807C57.28 5.96012 57.1404 5.59489 57.1404 5.17236V5.16162C57.1404 4.76058 57.2621 4.4043 57.5056 4.09277C57.7491 3.77767 58.0857 3.5306 58.5154 3.35156C58.9451 3.16895 59.441 3.07764 60.0032 3.07764C60.5653 3.07764 61.0613 3.16895 61.491 3.35156C61.9207 3.5306 62.2572 3.77767 62.5007 4.09277C62.7442 4.4043 62.866 4.76058 62.866 5.16162V5.17236C62.866 5.59489 62.7245 5.96012 62.4417 6.26807C62.1588 6.57243 61.7917 6.78011 61.3406 6.89111V6.92334C61.6915 6.99137 62.003 7.1167 62.2751 7.29932C62.5473 7.47835 62.7603 7.70394 62.9143 7.97607C63.0719 8.24821 63.1506 8.55257 63.1506 8.88916V8.8999C63.1506 9.34749 63.0181 9.74316 62.7532 10.0869C62.4882 10.4271 62.1176 10.6938 61.6414 10.8872C61.1687 11.077 60.6226 11.1719 60.0032 11.1719ZM60.0032 9.99023C60.2861 9.99023 60.5367 9.9401 60.7551 9.83984C60.9736 9.736 61.1436 9.59456 61.2654 9.41553C61.3907 9.23291 61.4534 9.02523 61.4534 8.79248V8.78174C61.4534 8.54899 61.3925 8.3431 61.2708 8.16406C61.149 7.98145 60.9789 7.83822 60.7605 7.73438C60.5421 7.63053 60.2896 7.57861 60.0032 7.57861C59.7167 7.57861 59.4643 7.63053 59.2458 7.73438C59.0274 7.83822 58.8556 7.98145 58.7302 8.16406C58.6085 8.3431 58.5476 8.54899 58.5476 8.78174V8.79248C58.5476 9.02523 58.6103 9.23291 58.7356 9.41553C58.8609 9.59456 59.0328 9.736 59.2512 9.83984C59.4696 9.9401 59.7203 9.99023 60.0032 9.99023ZM60.0032 6.40234C60.2502 6.40234 60.4687 6.35758 60.6584 6.26807C60.8482 6.17497 60.995 6.04785 61.0989 5.88672C61.2063 5.72559 61.26 5.53939 61.26 5.32812V5.31738C61.26 5.10612 61.2063 4.91992 61.0989 4.75879C60.9915 4.59766 60.8429 4.47233 60.6531 4.38281C60.4669 4.29329 60.2502 4.24854 60.0032 4.24854C59.7561 4.24854 59.5377 4.29329 59.3479 4.38281C59.1581 4.47233 59.0095 4.59766 58.9021 4.75879C58.7947 4.91992 58.741 5.10612 58.741 5.31738V5.32812C58.741 5.53939 58.7947 5.72559 58.9021 5.88672C59.0095 6.04785 59.1581 6.17497 59.3479 6.26807C59.5377 6.35758 59.7561 6.40234 60.0032 6.40234ZM67.0334 11.1987C66.3961 11.1987 65.8464 11.034 65.3845 10.7046C64.9262 10.3716 64.5735 9.90072 64.3264 9.29199C64.0793 8.68327 63.9558 7.96175 63.9558 7.12744V7.1167C63.9558 6.27881 64.0793 5.55729 64.3264 4.95215C64.5735 4.34342 64.9262 3.87435 65.3845 3.54492C65.8464 3.21549 66.3961 3.05078 67.0334 3.05078C67.6744 3.05078 68.224 3.21549 68.6824 3.54492C69.1407 3.87435 69.4934 4.34342 69.7405 4.95215C69.9875 5.55729 70.1111 6.27881 70.1111 7.1167V7.12744C70.1111 7.96175 69.9875 8.68327 69.7405 9.29199C69.4934 9.90072 69.1407 10.3716 68.6824 10.7046C68.224 11.034 67.6744 11.1987 67.0334 11.1987ZM67.0334 9.91504C67.3414 9.91504 67.601 9.80404 67.8123 9.58203C68.0271 9.36003 68.19 9.04134 68.301 8.62598C68.4156 8.21061 68.4729 7.7111 68.4729 7.12744V7.1167C68.4729 6.52946 68.4156 6.02995 68.301 5.61816C68.19 5.2028 68.0271 4.8859 67.8123 4.66748C67.601 4.44548 67.3414 4.33447 67.0334 4.33447C66.7291 4.33447 66.4695 4.44548 66.2546 4.66748C66.0434 4.8859 65.8805 5.2028 65.7659 5.61816C65.6549 6.02995 65.5994 6.52946 65.5994 7.1167V7.12744C65.5994 7.7111 65.6549 8.21061 65.7659 8.62598C65.8805 9.04134 66.0434 9.36003 66.2546 9.58203C66.4695 9.80404 66.7291 9.91504 67.0334 9.91504Z' fill='white'/%3E%3C/g%3E%3Cdefs%3E%3CclipPath id='clip0_0_1'%3E%3Crect x='50.9915' width='27.3587' height='14' rx='4' fill='white'/%3E%3C/clipPath%3E%3C/defs%3E%3C/svg%3E") !important;
}

/* 聊天页面状态栏样式 - 只在聊天页面显示时生效 - 统一标准 */
.chat-page.show .chat-status-bar {
  position: absolute !important;
  top: 10px !important; /* 与QQ主页状态栏位置完全一致 */
  left: 0 !important; /* 统一左边距 */
  right: 0 !important; /* 统一右边距 */
  height: 37px !important; /* 统一状态栏高度 */
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  padding: 0 20px !important; /* 统一左右内边距 */
  margin-top: 10px !important; /* 与QQ主页状态栏完全一致 */
  color: black !important;
  font-size: 18px !important; /* 统一字体大小 */
  font-weight: 700 !important; /* 统一字体粗细 */
  z-index: 50 !important; /* 提高z-index确保显示在最上层 */
  pointer-events: none !important;
}

.chat-page.show .chat-status-time {
  font-size: 18px; /* 统一时间字体大小 */
  font-weight: 700; /* 统一时间字体粗细 */
  color: black;
}

.chat-page.show .chat-status-icons {
  display: flex;
  align-items: center;
  gap: 4px; /* 统一图标间距 */
  color: black;
  font-size: 12px;
}

/* 使用SVG图标替换emoji - QQ聊天详情页状态栏 - 统一标准 */
.chat-page.show .chat-signal-icon,
.chat-page.show .chat-battery-icon {
  display: inline-block;
  width: 20px; /* 统一图标宽度 */
  height: 14px; /* 统一图标高度 */
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  font-size: 0; /* 隐藏emoji文字 */
}

.chat-page.show .chat-signal-icon {
  background-image: url("data:image/svg+xml,%3Csvg width='20' height='14' viewBox='0 0 20 14' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M19.8498 2.03301C19.8498 1.39996 19.3723 0.88678 18.7832 0.88678H17.7165C17.1274 0.88678 16.6498 1.39996 16.6498 2.03301V11.967C16.6498 12.6 17.1274 13.1132 17.7165 13.1132H18.7832C19.3723 13.1132 19.8498 12.6 19.8498 11.967V2.03301ZM12.4157 3.33206H13.4824C14.0715 3.33206 14.5491 3.85756 14.5491 4.5058V11.9395C14.5491 12.5877 14.0715 13.1132 13.4824 13.1132H12.4157C11.8266 13.1132 11.3491 12.5877 11.3491 11.9395V4.5058C11.3491 3.85756 11.8266 3.33206 12.4157 3.33206ZM8.08396 5.98111H7.01729C6.42819 5.98111 5.95062 6.5133 5.95062 7.16979V11.9245C5.95062 12.581 6.42819 13.1132 7.01729 13.1132H8.08396C8.67306 13.1132 9.15062 12.581 9.15062 11.9245V7.16979C9.15062 6.5133 8.67306 5.98111 8.08396 5.98111ZM2.78317 8.4264H1.71651C1.1274 8.4264 0.649841 8.95099 0.649841 9.5981V11.9415C0.649841 12.5886 1.1274 13.1132 1.71651 13.1132H2.78317C3.37228 13.1132 3.84984 12.5886 3.84984 11.9415V9.5981C3.84984 8.95099 3.37228 8.4264 2.78317 8.4264Z' fill='black'/%3E%3C/svg%3E");
}

.chat-page.show .chat-battery-icon {
  background-image: url("data:image/svg+xml,%3Csvg width='27' height='14' viewBox='50 0 28 14' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cg clip-path='url(%23clip0_0_1)'%3E%3Cg opacity='0.3'%3E%3Cpath d='M51.6574 1.77772C50.9915 2.78661 50.9915 4.19108 50.9915 7C50.9915 9.80892 50.9915 11.2134 51.6574 12.2223C51.9457 12.659 52.3162 13.034 52.7477 13.3259C53.7444 14 55.1319 14 57.9069 14H68.7741C71.5491 14 72.9366 14 73.9333 13.3259C74.3648 13.034 74.7353 12.659 75.0236 12.2223C75.6896 11.2134 75.6896 9.80892 75.6896 7C75.6896 4.19108 75.6896 2.78661 75.0236 1.77772C74.7353 1.34096 74.3648 0.965956 73.9333 0.674122C72.9366 0 71.5491 0 68.7741 0H57.9069C55.1319 0 53.7444 0 52.7477 0.674122C52.3162 0.965956 51.9457 1.34096 51.6574 1.77772Z' fill='%235A5A5A'/%3E%3Cpath d='M77.9915 6.75C77.9915 7.62313 77.4737 8.41122 76.6775 8.75V4.75C77.4737 5.08878 77.9915 5.87687 77.9915 6.75Z' fill='%235A5A5A'/%3E%3C/g%3E%3Crect width='21' height='14' transform='translate(50.9915)' fill='%23121212'/%3E%3Cpath d='M60.0032 11.1719C59.3801 11.1719 58.8323 11.077 58.3596 10.8872C57.887 10.6938 57.5181 10.4271 57.2532 10.0869C56.9882 9.74316 56.8557 9.34749 56.8557 8.8999V8.88916C56.8557 8.55257 56.9327 8.24821 57.0867 7.97607C57.2442 7.70394 57.4591 7.47835 57.7312 7.29932C58.0033 7.1167 58.3149 6.99137 58.6658 6.92334V6.89111C58.211 6.78011 57.8422 6.57243 57.5593 6.26807C57.28 5.96012 57.1404 5.59489 57.1404 5.17236V5.16162C57.1404 4.76058 57.2621 4.4043 57.5056 4.09277C57.7491 3.77767 58.0857 3.5306 58.5154 3.35156C58.9451 3.16895 59.441 3.07764 60.0032 3.07764C60.5653 3.07764 61.0613 3.16895 61.491 3.35156C61.9207 3.5306 62.2572 3.77767 62.5007 4.09277C62.7442 4.4043 62.866 4.76058 62.866 5.16162V5.17236C62.866 5.59489 62.7245 5.96012 62.4417 6.26807C62.1588 6.57243 61.7917 6.78011 61.3406 6.89111V6.92334C61.6915 6.99137 62.003 7.1167 62.2751 7.29932C62.5473 7.47835 62.7603 7.70394 62.9143 7.97607C63.0719 8.24821 63.1506 8.55257 63.1506 8.88916V8.8999C63.1506 9.34749 63.0181 9.74316 62.7532 10.0869C62.4882 10.4271 62.1176 10.6938 61.6414 10.8872C61.1687 11.077 60.6226 11.1719 60.0032 11.1719ZM60.0032 9.99023C60.2861 9.99023 60.5367 9.9401 60.7551 9.83984C60.9736 9.736 61.1436 9.59456 61.2654 9.41553C61.3907 9.23291 61.4534 9.02523 61.4534 8.79248V8.78174C61.4534 8.54899 61.3925 8.3431 61.2708 8.16406C61.149 7.98145 60.9789 7.83822 60.7605 7.73438C60.5421 7.63053 60.2896 7.57861 60.0032 7.57861C59.7167 7.57861 59.4643 7.63053 59.2458 7.73438C59.0274 7.83822 58.8556 7.98145 58.7302 8.16406C58.6085 8.3431 58.5476 8.54899 58.5476 8.78174V8.79248C58.5476 9.02523 58.6103 9.23291 58.7356 9.41553C58.8609 9.59456 59.0328 9.736 59.2512 9.83984C59.4696 9.9401 59.7203 9.99023 60.0032 9.99023ZM60.0032 6.40234C60.2502 6.40234 60.4687 6.35758 60.6584 6.26807C60.8482 6.17497 60.995 6.04785 61.0989 5.88672C61.2063 5.72559 61.26 5.53939 61.26 5.32812V5.31738C61.26 5.10612 61.2063 4.91992 61.0989 4.75879C60.9915 4.59766 60.8429 4.47233 60.6531 4.38281C60.4669 4.29329 60.2502 4.24854 60.0032 4.24854C59.7561 4.24854 59.5377 4.29329 59.3479 4.38281C59.1581 4.47233 59.0095 4.59766 58.9021 4.75879C58.7947 4.91992 58.741 5.10612 58.741 5.31738V5.32812C58.741 5.53939 58.7947 5.72559 58.9021 5.88672C59.0095 6.04785 59.1581 6.17497 59.3479 6.26807C59.5377 6.35758 59.7561 6.40234 60.0032 6.40234ZM67.0334 11.1987C66.3961 11.1987 65.8464 11.034 65.3845 10.7046C64.9262 10.3716 64.5735 9.90072 64.3264 9.29199C64.0793 8.68327 63.9558 7.96175 63.9558 7.12744V7.1167C63.9558 6.27881 64.0793 5.55729 64.3264 4.95215C64.5735 4.34342 64.9262 3.87435 65.3845 3.54492C65.8464 3.21549 66.3961 3.05078 67.0334 3.05078C67.6744 3.05078 68.224 3.21549 68.6824 3.54492C69.1407 3.87435 69.4934 4.34342 69.7405 4.95215C69.9875 5.55729 70.1111 6.27881 70.1111 7.1167V7.12744C70.1111 7.96175 69.9875 8.68327 69.7405 9.29199C69.4934 9.90072 69.1407 10.3716 68.6824 10.7046C68.224 11.034 67.6744 11.1987 67.0334 11.1987ZM67.0334 9.91504C67.3414 9.91504 67.601 9.80404 67.8123 9.58203C68.0271 9.36003 68.19 9.04134 68.301 8.62598C68.4156 8.21061 68.4729 7.7111 68.4729 7.12744V7.1167C68.4729 6.52946 68.4156 6.02995 68.301 5.61816C68.19 5.2028 68.0271 4.8859 67.8123 4.66748C67.601 4.44548 67.3414 4.33447 67.0334 4.33447C66.7291 4.33447 66.4695 4.44548 66.2546 4.66748C66.0434 4.8859 65.8805 5.2028 65.7659 5.61816C65.6549 6.02995 65.5994 6.52946 65.5994 7.1167V7.12744C65.5994 7.7111 65.6549 8.21061 65.7659 8.62598C65.8805 9.04134 66.0434 9.36003 66.2546 9.58203C66.4695 9.80404 66.7291 9.91504 67.0334 9.91504Z' fill='white'/%3E%3C/g%3E%3Cdefs%3E%3CclipPath id='clip0_0_1'%3E%3Crect x='50.9915' width='27.3587' height='14' rx='4' fill='white'/%3E%3C/clipPath%3E%3C/defs%3E%3C/svg%3E");
}

/* 隐藏未激活聊天页面的状态栏 */
.chat-page:not(.show) .chat-status-bar {
  display: none;
}

/* 修复状态栏重叠问题 - 当聊天页面显示时隐藏主QQ页面状态栏 */
.chat-page.show ~ * .qq-status-bar,
body:has(.chat-page.show) .qq-status-bar:not(.chat-status-bar) {
  display: none !important;
}

/* 确保只有聊天页面的状态栏在聊天页面激活时显示 */
.chat-page.show .chat-status-bar {
  display: flex !important;
}

/* 修复QQ主页顶部装饰栏重叠问题 - 当聊天页面显示时隐藏主页装饰栏 */
.chat-page.show ~ * .dialog-head,
body:has(.chat-page.show) .dialog-head {
  display: none !important;
}

/* 当聊天页面显示时，隐藏QQ主页的所有装饰元素 */
.chat-page.show ~ #chat_history_dialog .dialog-head,
.chat-page.show ~ #chat_history_dialog .qq-status-bar,
body:has(.chat-page.show) #chat_history_dialog .dialog-head,
body:has(.chat-page.show) #chat_history_dialog .qq-status-bar {
  display: none !important;
}

/* 在手机界面容器中，当聊天页面显示时隐藏QQ主页装饰栏 */
.chat-page.show ~ .qq-app-container .dialog-head,
.chat-page.show ~ .qq-app-container .qq-status-bar,
body:has(.chat-page.show) .qq-app-container .dialog-head,
body:has(.chat-page.show) .qq-app-container .qq-status-bar {
  display: none !important;
}

/* 强制隐藏QQ主页装饰栏 - 更强力的选择器 */
body .chat-page.show ~ * .dialog-head,
body .chat-page.show ~ * .qq-status-bar:not(.chat-status-bar),
.chat-page.show + * .dialog-head,
.chat-page.show + * .qq-status-bar:not(.chat-status-bar) {
  display: none !important;
  visibility: hidden !important;
  opacity: 0 !important;
  height: 0 !important;
  overflow: hidden !important;
}

/* 针对特定元素的强制隐藏 */
.chat-page.show ~ #chat_history_dialog > div > .dialog-head,
.chat-page.show ~ .qq-app-container > div > .dialog-head {
  display: none !important;
  visibility: hidden !important;
}

/* JavaScript控制的聊天详情页激活状态 */
body.chat-detail-active .dialog-head,
body.chat-detail-active .qq-status-bar:not(.chat-status-bar) {
  display: none !important;
  visibility: hidden !important;
  opacity: 0 !important;
  height: 0 !important;
  overflow: hidden !important;
}

/* QQ主页状态栏 */
.dialog-head {
  background: #f5f5f5 !important;
  color: #333 !important;
  padding: 48px 24px 12px !important;
  border-bottom: 1px solid #e0e0e0 !important;
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  flex-shrink: 0 !important;
  position: relative !important;
  z-index: 20 !important;
}

.dialog-head h3 {
  margin: 0 !important;
  font-size: 22px !important;
  font-weight: 600 !important;
  color: black !important;
  text-shadow: none !important;
}

/* 用户信息区域样式 */
.user-info-section {
  display: flex !important;
  align-items: center !important;
  gap: 12px !important;
}

.user-avatar-wrapper {
  position: relative;
  flex-shrink: 0;
}

.user-avatar {
  width: 48px !important;
  height: 48px !important;
  background-color: #f0f0f0 !important; /* 默认使用浅灰色背景，不使用蓝色 */
  color: #666 !important; /* 使用深灰色文字 */
  border-radius: 50% !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  font-size: 16px !important;
  font-weight: 600 !important;
  cursor: pointer !important;
  transition: all 0.2s ease !important;
  border: 2px solid #ddd !important; /* 添加边框 */
}

.user-avatar:hover {
  transform: scale(1.05) !important;
  border-color: #4caf50 !important;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2) !important;
}

.user-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.user-details {
  flex: 1;
  min-width: 0;
}

.user-details h3 {
  margin: 0 !important;
  font-size: 19px !important;
  font-weight: 600 !important;
  color: black !important;
  text-shadow: none !important;
}

/* QQ主页按钮样式 */
#create_group_btn {
  padding: 8px 12px !important;
  font-size: 24px !important;
  background: none !important;
  border: none !important;
  color: black !important;
  cursor: pointer !important;
  font-weight: bold !important;
}

#home_btn_main {
  padding: 8px 12px !important;
  font-size: 20px !important;
  background: none !important;
  border: none !important;
  color: black !important;
  cursor: pointer !important;
}

/* 小房子按钮样式 */
.home-btn {
  background: none !important;
  color: black !important;
  border: none !important;
  border-radius: 50% !important;
  width: 32px !important;
  height: 32px !important;
  cursor: pointer !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  font-size: 24px !important;
  transition: transform 0.2s ease !important;
  flex-shrink: 0 !important;
  user-select: none !important;
  padding: 0 !important;
}

.home-btn:hover {
  transform: scale(1.1) !important;
  background: none !important;
}

.home-btn:active {
  transform: scale(0.9) !important;
  background: none !important;
}

/* 创建群组按钮优化 */
#create_group_btn {
  background: none !important;
  color: black !important;
  border: none !important;
  border-radius: 0 !important;
  padding: 0 !important;
  font-size: 28px !important;
  cursor: pointer !important;
  transition: none !important;
  box-shadow: none !important;
  font-weight: normal !important;
  line-height: 1 !important;
  width: auto !important;
  height: auto !important;
}

#create_group_btn:hover {
  transform: none !important;
  box-shadow: none !important;
  background: none !important;
}

#create_group_btn:active {
  transform: none !important;
  box-shadow: none !important;
}

/* 主页内容区域 */
#history_content {
  flex: 1 !important;
  overflow-y: auto !important;
  background: white !important;
  position: relative !important;
  padding: 0 !important;
}

/* 可爱背景 */
#history_content::before {
  content: '';
  position: absolute;
  inset: 0;
  background-image: url('https://hebbkx1anhila5yf.public.blob.vercel-storage.com/Weixin%20Image_20250521091444.jpg-DuTc4plttvx6uYtNdextRDJciTiTgh.jpeg');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  opacity: 0.95;
  z-index: 0;
}

/* QQ联系人包装容器样式 */
.qq-contact-wrapper {
  position: relative;
  z-index: 10;
  padding: 18px 16px !important;
  margin: 0;
  background: transparent;
  border: none;
  border-bottom: 1px solid rgba(200, 200, 200, 0.2) !important;
  cursor: pointer;
  transition: background-color 0.2s ease;
  user-select: none;
}

.qq-contact-wrapper:hover,
.qq-contact-wrapper:active {
  background-color: rgba(255, 255, 255, 0.6) !important;
}

/* QQ群包装容器样式 */
.qq-group-wrapper {
  position: relative;
  z-index: 10;
  padding: 18px 16px !important;
  margin: 0;
  background: transparent;
  border: none;
  border-bottom: 1px solid rgba(200, 200, 200, 0.2) !important;
  cursor: pointer;
  transition: background-color 0.2s ease;
  user-select: none;
}

.qq-group-wrapper:hover,
.qq-group-wrapper:active {
  background-color: rgba(255, 255, 255, 0.6) !important;
}

/* 联系人和群组信息显示样式 */
.contact-summary,
.group-summary {
  display: flex;
  align-items: center;
  gap: 12px;
  pointer-events: none;
  position: relative;
}

.contact-header,
.group-header {
  display: flex;
  align-items: center;
  flex: 1;
  min-width: 0;
}

/* 头像容器样式 */
.contact-avatar-wrapper {
  position: relative;
  pointer-events: auto;
  flex-shrink: 0;
}

.custom-avatar {
  width: 48px !important;
  height: 48px !important;
  border-radius: 50% !important;
  border: 2px solid rgba(255, 255, 255, 0.5) !important;
  transition: transform 0.2s ease, border-color 0.2s ease !important;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
  cursor: pointer !important;
}

.custom-avatar:hover {
  transform: scale(1.05) !important;
  border-color: #4caf50 !important;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2) !important;
}

/* 群组图标标识 */
.qq-group-wrapper .contact-avatar-wrapper::after {
  content: '';
  position: absolute;
  bottom: -2px;
  right: -2px;
  width: 16px;
  height: 16px;
  background: #4a90e2;
  border-radius: 50%;
  border: 2px solid white;
  z-index: 1;
}

.qq-group-wrapper .contact-avatar-wrapper::before {
  content: '';
  position: absolute;
  bottom: 1px;
  right: 1px;
  width: 8px;
  height: 8px;
  background: white;
  border-radius: 50%;
  z-index: 2;
}

.contact-info,
.group-info {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-width: 0;
  margin-right: 12px;
}

.contact-name,
.group-name {
  font-weight: 600;
  color: black !important;
  font-size: 17px !important;
  margin-bottom: 4px !important;
  text-shadow: none !important;
}

.contact-number,
.group-id {
  color: #666;
  margin-left: 10px;
  font-size: 14px;
}

.contact-time,
.group-time {
  color: #555 !important;
  font-size: 14px !important;
  text-shadow: none !important;
  flex-shrink: 0 !important;
  font-weight: normal !important;
  margin-left: 8px !important;
}

.last-message {
  color: #333 !important;
  font-size: 16px !important;
  text-shadow: none !important;
  white-space: nowrap !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  max-width: 100% !important;
  margin-top: 4px !important;
}

/* 原有QQ联系人样式保持兼容 */
.custom-qqhao {
  display: block;
  padding: 0;
  margin: 0;
  background: transparent;
}

/* .custom-qqhao.sel 选中状态样式已移除 */

/* 原有QQ群组样式保持兼容 */
.custom-qq-qun {
  display: block;
  padding: 0;
  margin: 0;
  background: transparent;
}

/* .custom-qq-qun.sel 选中状态样式已移除 */

/* 消息容器样式 */
.custom-qq-cont,
.custom-qun-cont {
  position: relative;
  z-index: 10;
  padding: 16px;
  display: block;
  max-height: none;
  margin: 0;
  background: transparent;
}

/* 消息样式 - 优化定位更靠近屏幕边缘 */
.custom-message {
  display: flex;
  align-items: flex-end;
  margin-bottom: 15px !important;
  clear: both;
  gap: 4px; /* 减少头像和气泡间距 */
  position: relative;
  z-index: 5;
}

.custom-message.custom-sent {
  justify-content: flex-end;
  flex-direction: row;
  padding-right: 1px; /* 进一步靠近右边缘 */
  margin-right: 0; /* 完全贴近右边缘 */
}

.custom-message.custom-received {
  justify-content: flex-start;
  flex-direction: row;
  padding-left: 1px; /* 进一步靠近左边缘 */
  margin-left: 0; /* 完全贴近左边缘 */
}

/* 消息气泡统一样式 - 优化宽度利用屏幕空间 */
.message-bubble {
  max-width: calc(100% - 54px); /* 根据46px头像调整宽度 */
  padding: 10px 14px !important;
  border-radius: 18px !important;
  word-wrap: break-word;
  position: relative;
  font-size: 17px !important;
  line-height: 1.4;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08) !important;
  text-shadow: none !important;
}

.custom-sent .message-bubble {
  background: #007bff !important;
  color: white !important;
  border-bottom-right-radius: 6px !important;
}

.custom-received .message-bubble {
  background: #f0f0f0 !important;
  color: black !important;
  border-bottom-left-radius: 6px !important;
}

/* 消息头像 - 进一步放大尺寸并靠近边框 */
.message-avatar {
  width: 46px !important;
  height: 46px !important;
  border-radius: 50% !important;
  flex-shrink: 0 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  font-weight: bold;
  overflow: hidden;
  text-shadow: none !important;
  color: black !important;
  border: 2px solid rgba(255, 255, 255, 0.8) !important;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15) !important;
  background-size: cover !important;
  background-position: center !important;
  background-repeat: no-repeat !important;
}

/* 消息头像图片样式 */
.message-avatar img {
  width: 100% !important;
  height: 100% !important;
  object-fit: cover !important;
  border-radius: 50% !important;
}

/* 发送消息的头像样式 */
.sent-avatar {
  background-color: #007bff !important;
  color: white !important;
}

/* 当发送消息头像有图片时，隐藏文字和背景色 */
.sent-avatar img {
  background-color: transparent !important;
}

.sent-avatar:has(img) {
  background-color: transparent !important;
  color: transparent !important;
}

.message-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.sent-avatar {
  background-color: #007bff !important;
  color: white !important;
  font-size: 16px !important;
}

.received-avatar {
  background-color: #e9e9eb !important;
  font-size: 16px !important;
  color: #555 !important;
}

.group-avatar {
  background-color: #ddd !important;
  font-size: 16px !important;
  color: #444 !important;
}

/* 消息内时间戳 */
.message-bubble .message-time {
  font-size: 11px !important;
  opacity: 0.8;
  margin-top: 5px;
  text-align: right;
  display: block;
  clear: both;
  text-shadow: none !important;
}
.custom-sent .message-bubble .message-time {
  color: rgba(255, 255, 255, 0.8) !important;
}
.custom-received .message-bubble .message-time {
  color: #777 !important;
}

/* 群聊消息发送者名称 */
.message-bubble .sender-name {
  color: #007bff !important;
  font-weight: 600;
  margin-bottom: 3px;
  font-size: 14px !important;
  display: block;
  text-shadow: none !important;
}

/* 群聊消息项样式 */
.custom-qun-cont-item {
  margin-bottom: 12px;
  clear: both;
  position: relative;
  z-index: 10;
}

.custom-qun-cont-item .sender-name {
  color: #007bff !important;
  font-weight: 600;
  margin-bottom: 4px;
  font-size: 17px !important;
  text-shadow: none !important;
}

.custom-qun-cont-item .message-content {
  display: inline-block;
  background: white;
  color: black !important;
  padding: 12px 16px;
  border-radius: 18px;
  border-bottom-left-radius: 6px;
  max-width: 70%;
  word-wrap: break-word;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  font-size: 17px !important;
}

.custom-qun-cont-item .message-time {
  font-size: 12px !important;
  opacity: 0.7;
  color: #777 !important;
  margin-top: 4px;
  text-shadow: none !important;
}

/* 消息输入区域样式 */
.chat-input-area {
  padding: 12px 16px 32px !important;
  background: white !important;
  border-top: 1px solid #e0e0e0 !important;
  display: flex !important;
  align-items: center !important;
  flex-shrink: 0 !important;
  gap: 12px !important;
}

.message-input {
  flex: 1 !important;
  padding: 10px 16px !important;
  border: 1px solid #d1d5db !important;
  border-radius: 20px !important;
  background: #f9fafb !important;
  outline: none !important;
  font-size: 16px !important;
  color: #000000 !important; /* 确保输入文字为黑色 */
  transition: border-color 0.2s ease, background-color 0.2s ease !important;
  height: 40px !important;
  box-sizing: border-box !important;
}

.message-input:focus {
  border-color: #4a90e2 !important;
  background: white !important;
  color: #000000 !important; /* 确保焦点状态下文字也是黑色 */
  box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2) !important;
}

.send-btn {
  background: #4a90e2 !important;
  color: white !important;
  border: none !important;
  border-radius: 50% !important;
  width: 40px !important;
  height: 40px !important;
  cursor: pointer !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  font-size: 16px !important;
  transition: transform 0.2s ease, background-color 0.2s ease !important;
  flex-shrink: 0 !important;
}

.send-btn:hover {
  transform: scale(1.05);
  background: #357abd !important;
}

.send-btn:active {
  transform: scale(0.95);
}

/* 联系人和群组信息显示样式 - v0风格 */
.contact-summary,
.group-summary {
  display: flex;
  align-items: center;
  gap: 12px;
  pointer-events: none;
}

.contact-header,
.group-header {
  display: flex;
  align-items: center;
  flex: 1;
  min-width: 0;
}

/* 头像容器样式 - v0风格 */
.contact-avatar-wrapper {
  position: relative;
  pointer-events: auto;
  flex-shrink: 0;
}

.custom-avatar {
  width: 48px !important;
  height: 48px !important;
  border-radius: 50% !important;
  border: 2px solid rgba(255, 255, 255, 0.5) !important;
  transition: transform 0.2s ease, border-color 0.2s ease !important;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
  cursor: pointer !important;
}

.custom-avatar:hover {
  transform: scale(1.05) !important;
  border-color: #4caf50 !important;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2) !important;
}

/* 群组图标标识 */
.qq-group-wrapper .contact-avatar-wrapper::after {
  content: '';
  position: absolute;
  bottom: -2px;
  right: -2px;
  width: 16px;
  height: 16px;
  background: #4a90e2;
  border-radius: 50%;
  border: 2px solid white;
  z-index: 1;
}

.qq-group-wrapper .contact-avatar-wrapper::before {
  content: '';
  position: absolute;
  bottom: 1px;
  right: 1px;
  width: 8px;
  height: 8px;
  background: white;
  border-radius: 50%;
  z-index: 2;
}

.contact-info,
.group-info {
  flex: 1 !important;
  min-width: 0 !important;
  margin-right: 8px !important;
}

.contact-name-text,
.group-name-text {
  font-weight: 600 !important;
  color: black !important;
  font-size: 19px !important;
  text-shadow: none !important;
  white-space: nowrap !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  flex: 1 !important;
}

/* 聊天页面样式 - v0风格 */
.chat-page {
  position: fixed !important;
  top: 50% !important;
  left: 50% !important;
  width: 375px !important;
  height: 812px !important;
  background: transparent !important;
  z-index: 999 !important; /* 降低z-index，确保不会覆盖SillyTavern的其他界面 */
  display: none;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
  border-radius: 60px !important;
  padding: 8px !important;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4) !important;
  transform: translate(-50%, -50%) !important;
  opacity: 1 !important;
}

.chat-page::after {
  content: '';
  position: absolute;
  top: 8px;
  left: 8px;
  right: 8px;
  bottom: 8px;
  background: #ffffff !important;
  border-radius: 50px !important;
  z-index: -1;
  opacity: 1 !important;
  box-shadow: inset 0 0 0 2px rgba(255, 255, 255, 0.1) !important;
}

.chat-page > .chat-header,
.chat-page > .chat-messages,
.chat-page > .chat-input-area {
  position: relative;
  z-index: 1;
}

.chat-page.show {
  display: flex !important;
  flex-direction: column !important;
}

/* 聊天页面 Dynamic Island - 统一位置 */
.chat-page::before {
  content: '';
  position: absolute;
  top: 18px; /* Dynamic Island位置 */
  left: 50%;
  transform: translateX(-50%);
  width: 120px;
  height: 28px;
  background: black;
  border-radius: 20px;
  z-index: 100;
}

/* 聊天页面状态栏 - 统一标准位置 */
.chat-page .qq-status-bar {
  position: absolute !important;
  top: 10px !important; /* 统一顶部间距 */
  left: 0 !important; /* 统一左边距 */
  right: 0 !important; /* 统一右边距 */
  height: 37px !important; /* 统一状态栏高度 */
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  padding: 0 20px !important; /* 统一左右内边距 */
  color: black !important;
  font-size: 18px !important; /* 统一字体大小 */
  font-weight: 700 !important; /* 统一字体粗细 */
  z-index: 50 !important;
  pointer-events: none !important;
}

/* 聊天页面状态栏时间样式 - 统一标准 */
.chat-page .qq-status-time,
.chat-page .chat-status-time {
  font-size: 18px !important; /* 统一时间字体大小 */
  font-weight: 700 !important; /* 统一时间字体粗细 */
  color: black !important;
}

/* 聊天页面状态栏图标样式 - 统一标准 */
.chat-page .qq-status-icons {
  display: flex !important;
  align-items: center !important;
  gap: 4px !important; /* 统一图标间距 */
  font-size: 12px !important;
  color: black !important;
  font-weight: 600 !important;
}

/* 聊天头部样式 - 与QQ主页一致的高度 */
.chat-header {
  background: #f5f5f5 !important;
  color: #333 !important;
  padding: 48px 16px 12px !important; /* 与QQ主页一致的padding */
  display: flex !important;
  align-items: center !important;
  border-bottom: 1px solid #e0e0e0 !important;
  flex-shrink: 0 !important;
  justify-content: space-between !important;
  position: relative;
}

/* 返回QQ主列表的箭头按钮 */
.back-to-main-list-btn {
  background: none !important;
  border: none !important;
  color: black !important;
  font-size: 28px !important;
  font-weight: bold;
  cursor: pointer !important;
  padding: 0 !important;
  transition: transform 0.2s ease !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  width: 32px !important;
  height: 32px !important;
  user-select: none !important;
  position: absolute;
  left: 16px;
  top: 50%;
  transform: translateY(-50%);
}

.back-to-main-list-btn:hover {
  transform: translateY(-50%) scale(1.1) !important;
}

.back-to-main-list-btn:active {
  transform: translateY(-50%) scale(0.9) !important;
}

/* 聊天详情页的小房子按钮特定样式调整 */
.chat-home-btn {
  position: absolute;
  right: 16px;
  top: 50%;
  transform: translateY(-50%);
}

.chat-title {
  flex: 1;
  text-align: center;
  color: black !important;
  text-shadow: none !important;
  margin: 0 40px;
}

.chat-title > div:first-child {
  font-weight: 600 !important;
  font-size: 19px !important;
  margin-bottom: 2px !important;
  color: black !important;
  text-shadow: none !important;
}

.chat-title > div:last-child {
  font-size: 14px !important;
  opacity: 0.8 !important;
  display: flex !important;
  align-items: center !important;
  gap: 4px !important;
  color: #555 !important;
  text-shadow: none !important;
}

.chat-title > div:last-child::before {
  content: '';
  width: 8px;
  height: 8px;
  background: #4caf50;
  border-radius: 50%;
  display: inline-block;
}

/* 聊天消息区域样式 - v0风格 */
.chat-messages {
  flex: 1;
  overflow-y: auto;
  position: relative;
  min-height: 0;
  padding: 10px 8px !important; /* 减少左右内边距，让消息更靠近边缘 */
  z-index: 1;
}

/* 聊天背景 - 固定不动，只在消息区域显示 */
.chat-messages {
  background-image: url('https://hebbkx1anhila5yf.public.blob.vercel-storage.com/Weixin%20Image_20250521091444.jpg-DuTc4plttvx6uYtNdextRDJciTiTgh.jpeg') !important;
  background-size: cover !important;
  background-position: center !important;
  background-repeat: no-repeat !important;
  background-attachment: fixed !important;
  opacity: 0.95 !important;
}

.chat-messages::before {
  display: none;
}

/* 群聊消息项样式 - v0风格 */
.custom-qun-cont-item {
  margin-bottom: 12px;
  clear: both;
  position: relative;
  z-index: 10;
}

.custom-qun-cont-item .sender-name {
  color: #007bff !important;
  font-weight: 600;
  margin-bottom: 4px;
  font-size: 17px !important;
  text-shadow: none !important;
}

.custom-qun-cont-item .message-content {
  display: inline-block;
  background: white;
  color: black !important;
  padding: 12px 16px;
  border-radius: 18px;
  border-bottom-left-radius: 6px;
  max-width: 70%;
  word-wrap: break-word;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  font-size: 17px !important;
}

.custom-qun-cont-item .message-time {
  font-size: 12px !important;
  opacity: 0.7;
  color: #777 !important;
  margin-top: 4px;
  text-shadow: none !important;
}

/* 消息输入区域样式 - v0风格 */
.chat-input-area {
  padding: 12px 16px 32px !important;
  background: white !important;
  border-top: 1px solid #e0e0e0 !important;
  display: flex !important;
  align-items: center !important;
  flex-shrink: 0 !important;
  gap: 12px !important;
}

.message-input {
  flex: 1 !important;
  padding: 10px 16px !important;
  border: 1px solid #d1d5db !important;
  border-radius: 20px !important;
  background: #f9fafb !important;
  outline: none !important;
  font-size: 16px !important;
  transition: border-color 0.2s ease, background-color 0.2s ease !important;
  height: 40px !important;
  box-sizing: border-box !important;
}

.message-input:focus {
  border-color: #4a90e2 !important;
  background: white !important;
  box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2) !important;
}

.send-btn {
  background: #4a90e2 !important;
  color: white !important;
  border: none !important;
  border-radius: 50% !important;
  width: 40px !important;
  height: 40px !important;
  cursor: pointer !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  font-size: 16px !important;
  transition: transform 0.2s ease, background-color 0.2s ease !important;
  flex-shrink: 0 !important;
}

.send-btn:hover {
  transform: scale(1.05);
  background: #357abd !important;
}

.send-btn:active {
  transform: scale(0.95);
}

/* 移除旧的选中状态样式 */
.custom-qqhao,
.custom-qq-qun {
  background: transparent !important;
  padding: 0 !important;
  margin: 0 !important;
  box-shadow: none !important;
  color: inherit !important;
  display: block !important;
}

/* 消息时间样式 */
.message-time {
  font-size: 12px !important;
  opacity: 0.7;
  margin-top: 4px;
  text-shadow: none !important;
  color: #777 !important;
}

/* 群聊消息发送者名称样式 */
.sender-name {
  font-weight: 600;
  margin-bottom: 5px;
  font-size: 15px !important;
  text-shadow: none !important;
}

/* 群聊消息内容样式 */
.message-content {
  color: black !important;
  font-size: 17px !important;
}

/* 添加群员按钮样式 */
.add-member-btn {
  position: absolute;
  right: 55px; /* 调整位置避免与小房子按钮重叠 */
  top: 50%;
  transform: translateY(-50%);
  width: 32px;
  height: 32px;
  border: none;
  background: transparent; /* 移除蓝色背景 */
  color: #333;
  border-radius: 50%;
  cursor: pointer;
  font-size: 20px; /* 调整+号大小 */
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background-color 0.2s ease;
}

.add-member-btn:hover {
  background: rgba(0, 0, 0, 0.1); /* 悬停时显示浅色背景 */
}

/* 滚动条样式优化 */
.chat-messages::-webkit-scrollbar {
  width: 4px;
}

.chat-messages::-webkit-scrollbar-track {
  background: transparent;
}

.chat-messages::-webkit-scrollbar-thumb {
  background-color: rgba(0, 0, 0, 0.2);
  border-radius: 2px;
}

.chat-messages::-webkit-scrollbar-thumb:hover {
  background-color: rgba(0, 0, 0, 0.4);
}

#history_content::-webkit-scrollbar {
  width: 4px;
}

#history_content::-webkit-scrollbar-track {
  background: transparent;
}

#history_content::-webkit-scrollbar-thumb {
  background-color: rgba(0, 0, 0, 0.2);
  border-radius: 2px;
}

#history_content::-webkit-scrollbar-thumb:hover {
  background-color: rgba(0, 0, 0, 0.4);
}

/* Home Indicator */
.chat-page .chat-input-area::after {
  content: '';
  position: absolute;
  bottom: 8px;
  left: 50%;
  transform: translateX(-50%);
  width: 120px;
  height: 4px;
  background: black;
  border-radius: 2px;
  z-index: 100;
}

/* 确保按钮文字不被选中 */
.back-btn,
.send-btn,
.add-member-btn {
  user-select: none !important;
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
}

/* 优化联系人布局 */
.contact-name,
.group-name {
  display: flex !important;
  align-items: center !important;
  justify-content: space-between !important;
  width: 100% !important;
  margin-bottom: 4px !important;
}

.contact-name-text,
.group-name-text {
  font-weight: 600 !important;
  color: black !important;
  font-size: 19px !important;
  text-shadow: none !important;
  white-space: nowrap !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  flex: 1 !important;
}

.contact-time,
.group-time {
  color: #555 !important;
  font-size: 14px !important;
  text-shadow: none !important;
  flex-shrink: 0 !important;
  font-weight: normal !important;
  margin-left: 8px !important;
}

/* 隐藏QQ号显示 */
.contact-number,
.group-id {
  display: none !important;
}

/* 最后消息样式优化 */
.last-message {
  color: #333 !important;
  font-size: 16px !important;
  text-shadow: none !important;
  white-space: nowrap !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  max-width: 100% !important;
  margin-top: 4px !important;
}

/* 联系人信息区域优化 */
.contact-info,
.group-info {
  flex: 1 !important;
  min-width: 0 !important;
  margin-right: 8px !important;
}

/* 通用文字阴影去除 */
* {
  text-shadow: none !important;
}

/* 确保图标无阴影 - 特别是状态栏图标 */
.qq-status-icons div,
.qq-signal-icon::before,
.qq-battery-icon::before,
.qq-battery-icon::after,
.home-btn,
.back-to-main-list-btn,
#create_group_btn {
  text-shadow: none !important;
  box-shadow: none !important;
}

/* 聊天标题状态文字（QQ号/群号） */
.contact-status-qq {
  font-size: 14px !important;
  opacity: 0.8 !important;
  color: #555 !important;
  text-shadow: none !important;
  margin-top: 2px;
}

.chat-title > div:last-child::before {
  content: '' !important;
  width: 0 !important;
  height: 0 !important;
  background: none !important;
  border-radius: 0 !important;
  display: none !important;
}

/* 确保所有聊天输入框的字体颜色都是黑色 */
.chat-page .message-input,
.qq-app-container .message-input,
#chat_history_dialog .message-input,
input.message-input,
textarea.message-input {
  color: #000000 !important;
}

.chat-page .message-input:focus,
.qq-app-container .message-input:focus,
#chat_history_dialog .message-input:focus,
input.message-input:focus,
textarea.message-input:focus {
  color: #000000 !important;
}
