<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰‹æœºç•Œé¢å°ºå¯¸é™åˆ¶æµ‹è¯•</title>
    
    <!-- å¼•å…¥jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <!-- å¼•å…¥æ ·å¼æ–‡ä»¶ -->
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/phone-interface.css">
    
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .test-header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .test-title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .test-subtitle {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .test-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            min-width: 280px;
        }
        
        .panel-section {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .panel-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .section-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 13px;
        }
        
        .info-label {
            color: #666;
        }
        
        .info-value {
            color: #007bff;
            font-weight: bold;
        }
        
        .test-btn {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, #ff9ad5 0%, #a88beb 100%);
            color: white;
            cursor: pointer;
            font-weight: bold;
            margin-bottom: 8px;
            transition: transform 0.2s ease;
        }
        
        .test-btn:hover {
            transform: translateY(-1px);
        }
        
        .size-comparison {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 1000;
        }
        
        .comparison-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }
        
        .size-demo {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            font-size: 12px;
        }
        
        .size-box {
            width: 20px;
            height: 40px;
            border: 2px solid #007bff;
            border-radius: 4px;
            position: relative;
        }
        
        .size-box.original {
            background: rgba(0, 123, 255, 0.2);
        }
        
        .size-box.scaled {
            background: rgba(255, 154, 213, 0.3);
            border-color: #ff9ad5;
        }
        
        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 5px;
        }
        
        .status-indicator.good {
            background: #28a745;
        }
        
        .status-indicator.warning {
            background: #ffc107;
        }
        
        .status-indicator.info {
            background: #17a2b8;
        }
    </style>
</head>
<body>
    <div class="test-header">
        <div class="test-title">ğŸ“ æ‰‹æœºç•Œé¢å°ºå¯¸é™åˆ¶æµ‹è¯•</div>
        <div class="test-subtitle">éªŒè¯åœ¨å¤§å±å¹•è®¾å¤‡ä¸Šçš„å°ºå¯¸æ§åˆ¶æ•ˆæœ</div>
    </div>
    
    <div class="test-panel">
        <div class="panel-section">
            <div class="section-title">å±å¹•ä¿¡æ¯</div>
            <div class="info-row">
                <span class="info-label">çª—å£å°ºå¯¸:</span>
                <span class="info-value" id="window_size">-</span>
            </div>
            <div class="info-row">
                <span class="info-label">è®¾å¤‡ç±»å‹:</span>
                <span class="info-value" id="device_type">-</span>
            </div>
            <div class="info-row">
                <span class="info-label">åƒç´ æ¯”:</span>
                <span class="info-value" id="pixel_ratio">-</span>
            </div>
        </div>
        
        <div class="panel-section">
            <div class="section-title">ç¼©æ”¾ä¿¡æ¯</div>
            <div class="info-row">
                <span class="info-label">å½“å‰ç¼©æ”¾:</span>
                <span class="info-value" id="current_scale">-</span>
            </div>
            <div class="info-row">
                <span class="info-label">å®é™…å°ºå¯¸:</span>
                <span class="info-value" id="actual_size">-</span>
            </div>
            <div class="info-row">
                <span class="info-label">é™åˆ¶çŠ¶æ€:</span>
                <span class="info-value" id="limit_status">-</span>
            </div>
        </div>
        
        <div class="panel-section">
            <div class="section-title">æµ‹è¯•æ“ä½œ</div>
            <button class="test-btn" onclick="togglePhone()">æ˜¾ç¤º/éšè—æ‰‹æœº</button>
            <button class="test-btn" onclick="testLargeScreen()">æ¨¡æ‹Ÿå¤§å±å¹•</button>
            <button class="test-btn" onclick="testSmallScreen()">æ¨¡æ‹Ÿå°å±å¹•</button>
            <button class="test-btn" onclick="resetScreen()">é‡ç½®å±å¹•</button>
        </div>
    </div>
    
    <div class="size-comparison">
        <div class="comparison-title">å°ºå¯¸å¯¹æ¯”</div>
        <div class="size-demo">
            <div class="size-box original"></div>
            <span>åŸå§‹å°ºå¯¸ (375Ã—812)</span>
        </div>
        <div class="size-demo">
            <div class="size-box scaled"></div>
            <span>å½“å‰æ˜¾ç¤ºå°ºå¯¸</span>
        </div>
        <div style="margin-top: 10px; font-size: 11px; color: #666;">
            <div><span class="status-indicator good"></span>æ­£å¸¸ç¼©æ”¾</div>
            <div><span class="status-indicator warning"></span>è¾¾åˆ°ä¸Šé™</div>
            <div><span class="status-indicator info"></span>è‡ªé€‚åº”ç¼©å°</div>
        </div>
    </div>

    <!-- å¼•å…¥æ‰‹æœºç•Œé¢è„šæœ¬ -->
    <script src="apps/phone-interface.js"></script>
    
    <script>
        let originalWindowSize = { width: window.innerWidth, height: window.innerHeight };
        
        // æ›´æ–°æ‰€æœ‰ä¿¡æ¯
        function updateAllInfo() {
            updateScreenInfo();
            updateScaleInfo();
            updateSizeComparison();
        }
        
        // æ›´æ–°å±å¹•ä¿¡æ¯
        function updateScreenInfo() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            
            $('#window_size').text(`${width} Ã— ${height}`);
            $('#pixel_ratio').text(window.devicePixelRatio || 1);
            
            // åˆ¤æ–­è®¾å¤‡ç±»å‹
            let deviceType = 'æ¡Œé¢';
            if (width <= 480) deviceType = 'æ‰‹æœº';
            else if (width <= 768) deviceType = 'å°å¹³æ¿';
            else if (width <= 1024) deviceType = 'å¹³æ¿';
            else if (width <= 1440) deviceType = 'ç¬”è®°æœ¬';
            else deviceType = 'å¤§å±å¹•';
            
            $('#device_type').text(deviceType);
        }
        
        // æ›´æ–°ç¼©æ”¾ä¿¡æ¯
        function updateScaleInfo() {
            const $phone = $('#phone_interface');
            if ($phone.length > 0) {
                const scale = parseFloat($phone.css('--phone-scale') || '1');
                const actualWidth = Math.round(375 * scale);
                const actualHeight = Math.round(812 * scale);
                
                $('#current_scale').text(`${(scale * 100).toFixed(0)}%`);
                $('#actual_size').text(`${actualWidth} Ã— ${actualHeight}`);
                
                // åˆ¤æ–­é™åˆ¶çŠ¶æ€
                let limitStatus = '';
                if (scale >= 1.0) {
                    limitStatus = 'å·²è¾¾ä¸Šé™';
                } else if (scale >= 0.9) {
                    limitStatus = 'æ­£å¸¸æ˜¾ç¤º';
                } else {
                    limitStatus = 'è‡ªé€‚åº”ç¼©å°';
                }
                $('#limit_status').text(limitStatus);
            } else {
                $('#current_scale').text('æœªåˆå§‹åŒ–');
                $('#actual_size').text('-');
                $('#limit_status').text('-');
            }
        }
        
        // æ›´æ–°å°ºå¯¸å¯¹æ¯”
        function updateSizeComparison() {
            const $phone = $('#phone_interface');
            if ($phone.length > 0) {
                const scale = parseFloat($phone.css('--phone-scale') || '1');
                const scaledBox = $('.size-box.scaled');
                
                // è°ƒæ•´å¯¹æ¯”æ¡†çš„é«˜åº¦
                const newHeight = Math.round(40 * scale);
                scaledBox.css('height', `${newHeight}px`);
                
                // æ›´æ–°è¾¹æ¡†é¢œè‰²è¡¨ç¤ºçŠ¶æ€
                if (scale >= 1.0) {
                    scaledBox.css('border-color', '#ffc107'); // è­¦å‘Šè‰²
                } else if (scale >= 0.9) {
                    scaledBox.css('border-color', '#28a745'); // æˆåŠŸè‰²
                } else {
                    scaledBox.css('border-color', '#17a2b8'); // ä¿¡æ¯è‰²
                }
            }
        }
        
        // åˆ‡æ¢æ‰‹æœºæ˜¾ç¤º
        function togglePhone() {
            if (window.PhoneInterface) {
                const $phone = $('#phone_interface');
                if ($phone.hasClass('show')) {
                    window.PhoneInterface.hide();
                } else {
                    window.PhoneInterface.show();
                }
                setTimeout(updateAllInfo, 100);
            }
        }
        
        // æµ‹è¯•å¤§å±å¹•
        function testLargeScreen() {
            simulateWindowSize(1920, 1080);
            console.log('ğŸ–¥ï¸ æ¨¡æ‹Ÿå¤§å±å¹•: 1920Ã—1080 - éªŒè¯å°ºå¯¸é™åˆ¶æ•ˆæœ');
        }
        
        // æµ‹è¯•å°å±å¹•
        function testSmallScreen() {
            simulateWindowSize(375, 667);
            console.log('ğŸ“± æ¨¡æ‹Ÿå°å±å¹•: 375Ã—667 - éªŒè¯è‡ªé€‚åº”ç¼©æ”¾');
        }
        
        // é‡ç½®å±å¹•
        function resetScreen() {
            simulateWindowSize(originalWindowSize.width, originalWindowSize.height);
            console.log('ğŸ”„ é‡ç½®åˆ°åŸå§‹å±å¹•å°ºå¯¸');
        }
        
        // æ¨¡æ‹Ÿçª—å£å°ºå¯¸
        function simulateWindowSize(width, height) {
            Object.defineProperty(window, 'innerWidth', {
                writable: true,
                configurable: true,
                value: width
            });
            Object.defineProperty(window, 'innerHeight', {
                writable: true,
                configurable: true,
                value: height
            });
            
            $(window).trigger('resize');
            setTimeout(updateAllInfo, 100);
        }
        
        // é¡µé¢åˆå§‹åŒ–
        $(document).ready(function() {
            console.log('å°ºå¯¸é™åˆ¶æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
            
            // ä¿å­˜åŸå§‹çª—å£å°ºå¯¸
            originalWindowSize = { width: window.innerWidth, height: window.innerHeight };
            
            // åˆå§‹åŒ–æ‰‹æœºç•Œé¢
            if (window.PhoneInterface) {
                window.PhoneInterface.init();
                console.log('âœ… æ‰‹æœºç•Œé¢åˆå§‹åŒ–å®Œæˆ');
            } else {
                setTimeout(() => {
                    if (window.PhoneInterface) {
                        window.PhoneInterface.init();
                        console.log('âœ… æ‰‹æœºç•Œé¢åˆå§‹åŒ–å®Œæˆï¼ˆå»¶è¿Ÿï¼‰');
                    }
                }, 1000);
            }
            
            // æ›´æ–°ä¿¡æ¯
            updateAllInfo();
            
            // ç›‘å¬çª—å£å˜åŒ–
            $(window).on('resize orientationchange', function() {
                setTimeout(updateAllInfo, 100);
            });
            
            // å®šæœŸæ›´æ–°
            setInterval(updateAllInfo, 3000);
        });
    </script>
</body>
</html>
