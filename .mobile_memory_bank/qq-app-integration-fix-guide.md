# QQåº”ç”¨æ‰‹æœºç•Œé¢é›†æˆä¿®å¤æŒ‡å—

## ğŸ“‹ é—®é¢˜æ¦‚è¿°

åœ¨å°†QQåº”ç”¨é›†æˆåˆ°æ‰‹æœºç•Œé¢æ—¶é‡åˆ°äº†ç™½å±é—®é¢˜ï¼ŒåŒ…æ‹¬ç¬¬ä¸€æ¬¡è¿›å…¥ç™½å±å’Œé‡å¤è¿›å…¥å¤±è´¥çš„é—®é¢˜ã€‚ç»è¿‡æ·±åº¦è°ƒè¯•ï¼Œå‘ç°äº†ä¸¤ä¸ªå…³é”®é—®é¢˜å¹¶æˆåŠŸä¿®å¤ã€‚

## ğŸ› é‡åˆ°çš„é—®é¢˜

### é—®é¢˜1ï¼šç¬¬ä¸€æ¬¡è¿›å…¥ç™½å±
**ç°è±¡**ï¼šåˆ·æ–°é¡µé¢åç¬¬ä¸€æ¬¡ç‚¹å‡»QQåº”ç”¨æ˜¾ç¤ºç™½å±
**æ ¹æœ¬åŸå› **ï¼šæ—¶åºé—®é¢˜ - æ‰‹æœºç•Œé¢æ¨¡å¼æ£€æŸ¥åœ¨ç±»åè®¾ç½®ä¹‹å‰æ‰§è¡Œ

### é—®é¢˜2ï¼šé‡å¤è¿›å…¥å¤±è´¥
**ç°è±¡**ï¼šç¬¬ä¸€æ¬¡è¿›å…¥æ­£å¸¸ï¼Œé€€å‡ºåå†æ¬¡è¿›å…¥æ˜¾ç¤ºç™½å±
**æ ¹æœ¬åŸå› **ï¼šåŸå§‹å¯¹è¯æ¡†è¢«æ„å¤–ç§»é™¤

## ğŸ” è¯¦ç»†åˆ†æ

### é—®é¢˜1åˆ†æï¼šæ—¶åºé—®é¢˜

**é”™è¯¯çš„æ‰§è¡Œé¡ºåº**ï¼š
1. ç‚¹å‡»QQåº”ç”¨å›¾æ ‡
2. è°ƒç”¨ `QQApp.show()` æ–¹æ³•
3. `show()` æ–¹æ³•æ£€æŸ¥ `$('#phone_interface').hasClass('show-qq-app-content')` â†’ è¿”å› `false`
4. æ‰§è¡Œç‹¬ç«‹æ˜¾ç¤ºé€»è¾‘ï¼ˆä¸åœ¨æ‰‹æœºç•Œé¢å†…ï¼‰
5. **ä¹‹å**æ‰æ·»åŠ  `show-qq-app-content` ç±»å

**é—®é¢˜ä»£ç ä½ç½®**ï¼š`phone-interface.js` ç¬¬361-385è¡Œ
```javascript
// é”™è¯¯çš„é¡ºåº
appObject.show(); // å…ˆè°ƒç”¨showæ–¹æ³•
if (appName === 'QQApp') {
  $('#phone_interface').addClass('show show-qq-app-content'); // åè®¾ç½®ç±»å
}
```

### é—®é¢˜2åˆ†æï¼šåŸå§‹å¯¹è¯æ¡†è¢«ç§»é™¤

**é”™è¯¯çš„æ¸…ç†é€»è¾‘**ï¼š
åœ¨ `closeAllApps()` æ–¹æ³•ä¸­ï¼Œæœ‰è¿™æ ·çš„ä»£ç ï¼š
```javascript
$('[id*="_dialog"]').remove(); // è¿™ä¼šç§»é™¤ #chat_history_dialog
```

**æ‰§è¡Œæµç¨‹**ï¼š
1. ç”¨æˆ·ç‚¹å‡»å°æˆ¿å­æŒ‰é’®æˆ–ç‚¹å‡»å¤–éƒ¨åŒºåŸŸ
2. è§¦å‘ `closeAllApps()` æ–¹æ³•
3. `$('[id*="_dialog"]').remove()` ç§»é™¤äº† `#chat_history_dialog`
4. ç¬¬äºŒæ¬¡è¿›å…¥æ—¶æ‰¾ä¸åˆ°åŸå§‹å¯¹è¯æ¡† â†’ ç™½å±

## âœ… è§£å†³æ–¹æ¡ˆ

### è§£å†³æ–¹æ¡ˆ1ï¼šè°ƒæ•´æ‰§è¡Œé¡ºåº

**ä¿®å¤ä½ç½®**ï¼š`src/mobile-ui-test/apps/phone-interface.js` ç¬¬361-389è¡Œ

**ä¿®å¤å‰**ï¼š
```javascript
const openApp = (appName, appObject) => {
  if (appObject && typeof appObject.show === 'function') {
    appObject.show(); // å…ˆè°ƒç”¨

    if (appName === 'QQApp') {
      $('#phone_interface').addClass('show show-qq-app-content'); // åè®¾ç½®
    }
  }
};
```

**ä¿®å¤å**ï¼š
```javascript
const openApp = (appName, appObject) => {
  if (appObject && typeof appObject.show === 'function') {
    if (appName === 'QQApp') {
      // åœ¨è°ƒç”¨showæ–¹æ³•ä¹‹å‰å…ˆè®¾ç½®æ‰‹æœºç•Œé¢æ¨¡å¼
      $('#phone_interface').addClass('show show-qq-app-content');
      $('body').addClass('qq-app-mode');
    }

    // è°ƒç”¨åº”ç”¨çš„showæ–¹æ³•
    appObject.show();
  }
};
```

### è§£å†³æ–¹æ¡ˆ2ï¼šä¿æŠ¤åŸå§‹å¯¹è¯æ¡†

**ä¿®å¤ä½ç½®**ï¼š`src/mobile-ui-test/apps/phone-interface.js` ç¬¬515è¡Œ

**ä¿®å¤å‰**ï¼š
```javascript
$('[id*="_dialog"]').remove(); // ä¼šç§»é™¤æ‰€æœ‰åŒ…å«_dialogçš„å…ƒç´ 
```

**ä¿®å¤å**ï¼š
```javascript
$('[id*="_dialog"]:not(#chat_history_dialog)').remove(); // ä¿ç•™QQåº”ç”¨çš„åŸå§‹å¯¹è¯æ¡†
```

## ğŸ¯ å…³é”®ç»éªŒæ•™è®­

### 1. æ—¶åºå¾ˆé‡è¦
- åœ¨è°ƒç”¨åº”ç”¨çš„ `show()` æ–¹æ³•ä¹‹å‰ï¼Œå¿…é¡»å…ˆè®¾ç½®å¥½æ‰€æœ‰å¿…è¦çš„çŠ¶æ€
- åº”ç”¨å†…éƒ¨çš„é€»è¾‘æ£€æŸ¥ä¼šåœ¨åˆå§‹åŒ–æ—¶ç«‹å³æ‰§è¡Œ

### 2. æ¸…ç†é€»è¾‘è¦ç²¾ç¡®
- ä½¿ç”¨é€šé…ç¬¦é€‰æ‹©å™¨æ—¶è¦å°å¿ƒï¼Œé¿å…è¯¯åˆ é‡è¦å…ƒç´ 
- å¯¹äºæ ¸å¿ƒç»„ä»¶ï¼ˆå¦‚åŸå§‹å¯¹è¯æ¡†ï¼‰ï¼Œéœ€è¦æ˜ç¡®ä¿æŠ¤

### 3. è°ƒè¯•ç­–ç•¥
- æ·»åŠ è¯¦ç»†çš„æ§åˆ¶å°æ—¥å¿—æ¥è¿½è¸ªæ‰§è¡Œæµç¨‹
- æ£€æŸ¥å…³é”®çŠ¶æ€çš„å˜åŒ–æ—¶æœº
- ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·ç›‘æ§DOMå˜åŒ–

## ğŸ“ å…¶ä»–åº”ç”¨å¼€å‘æŒ‡å—

### ä¸ºæ–°åº”ç”¨é›†æˆæ‰‹æœºç•Œé¢æ—¶çš„æ£€æŸ¥æ¸…å•

#### âœ… æ—¶åºæ£€æŸ¥
- [ ] ç¡®ä¿åœ¨è°ƒç”¨åº”ç”¨çš„ `show()` æ–¹æ³•**ä¹‹å‰**è®¾ç½®æ‰‹æœºç•Œé¢æ¨¡å¼ç±»å
- [ ] éªŒè¯åº”ç”¨å†…éƒ¨çš„æ¨¡å¼æ£€æŸ¥é€»è¾‘åœ¨æ­£ç¡®çš„æ—¶æœºæ‰§è¡Œ

#### âœ… æ¸…ç†é€»è¾‘æ£€æŸ¥
- [ ] æ£€æŸ¥ `closeAllApps()` æ–¹æ³•æ˜¯å¦ä¼šè¯¯åˆ åº”ç”¨çš„æ ¸å¿ƒå…ƒç´ 
- [ ] å¦‚æœåº”ç”¨æœ‰åŸå§‹å¯¹è¯æ¡†æˆ–å®¹å™¨ï¼Œç¡®ä¿åœ¨æ¸…ç†æ—¶è¢«ä¿æŠ¤
- [ ] ä½¿ç”¨ç²¾ç¡®çš„é€‰æ‹©å™¨è€Œä¸æ˜¯é€šé…ç¬¦

#### âœ… å®¹å™¨ç®¡ç†æ£€æŸ¥
- [ ] ç¡®ä¿åº”ç”¨æœ‰ç¨³å®šçš„åŸå§‹å®¹å™¨ç»“æ„
- [ ] éªŒè¯å…‹éš†/ç§»åŠ¨é€»è¾‘ä¸ä¼šç ´ååŸå§‹ç»“æ„
- [ ] æµ‹è¯•é‡å¤è¿›å…¥å’Œé€€å‡ºçš„åœºæ™¯

#### âœ… è°ƒè¯•å‡†å¤‡
- [ ] æ·»åŠ è¯¦ç»†çš„æ§åˆ¶å°æ—¥å¿—
- [ ] åŒ…å«å…³é”®çŠ¶æ€çš„æ£€æŸ¥ç‚¹
- [ ] å‡†å¤‡æµ‹è¯•å†…å®¹ä»¥éªŒè¯å®¹å™¨å·¥ä½œçŠ¶æ€

### æ¨èçš„åº”ç”¨é›†æˆæ¨¡å¼

```javascript
// åœ¨ phone-interface.js çš„ openApp å‡½æ•°ä¸­
const openApp = (appName, appObject) => {
  if (appObject && typeof appObject.show === 'function') {
    // 1. å…ˆè®¾ç½®æ‰‹æœºç•Œé¢æ¨¡å¼ï¼ˆå¦‚æœéœ€è¦ï¼‰
    if (appName === 'YourApp') {
      $('#phone_interface').addClass('show show-yourapp-content');
      $('body').addClass('yourapp-mode');
    }

    // 2. å†è°ƒç”¨åº”ç”¨çš„showæ–¹æ³•
    appObject.show();

    // 3. å¤„ç†å…¶ä»–åº”ç”¨çš„æ¸…ç†é€»è¾‘
    if (appName !== 'YourApp') {
      setTimeout(() => {
        $('#phone_interface').removeClass('show show-yourapp-content');
        $('body').removeClass('yourapp-mode');
      }, 0);
    }
  }
};
```

```javascript
// åœ¨ closeAllApps æ–¹æ³•ä¸­ä¿æŠ¤ä½ çš„åº”ç”¨å®¹å™¨
$('[id*="_dialog"]:not(#your_app_dialog)').remove();
```

## ğŸ‰ ä¿®å¤ç»“æœ

- âœ… ç¬¬ä¸€æ¬¡è¿›å…¥QQåº”ç”¨æ­£å¸¸æ˜¾ç¤º
- âœ… é‡å¤è¿›å…¥QQåº”ç”¨æ­£å¸¸æ˜¾ç¤º
- âœ… æ‰€æœ‰äº¤äº’åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- âœ… æ‰‹æœºç•Œé¢å’ŒQQåº”ç”¨å®Œç¾é›†æˆ

## ğŸ“š ç›¸å…³æ–‡ä»¶

- `src/mobile-ui-test/apps/phone-interface.js` - æ‰‹æœºç•Œé¢ä¸»æ§åˆ¶å™¨
- `src/mobile-ui-test/apps/qq-app.js` - QQåº”ç”¨é€»è¾‘
- `src/mobile-ui-test/æµ‹è¯•è¯´æ˜.md` - è¯¦ç»†æµ‹è¯•æ–‡æ¡£

---

**åˆ›å»ºæ—¶é—´**ï¼š2024å¹´12æœˆ
**é€‚ç”¨ç‰ˆæœ¬**ï¼šTavern Helper Template v1.0
**çŠ¶æ€**ï¼šå·²ä¿®å¤å¹¶éªŒè¯
